{\ssp
\begin{lstlisting}[language=PHP, caption={[Example of an information leakage EAR vulnerability.]Example of  an
  information leakage Execution After Redirect vulnerability in PHP.
  If the \texttt{current\_user} is not an administrator, the PHP
  \texttt{header} function will be called, redirecting the user to
  ``/''. However, the sensitive information will still be returned in
  the output, thus leaking information. The fix is to call the
  \texttt{exit} function after the \texttt{header} call.},
  label=\currentprefix:code:php-example, float]
$current_user = get_current_user();
if (!$current_user->is_admin())
{
   header("Location: /");
}
echo "Sensitive Information";
\end{lstlisting}
}
